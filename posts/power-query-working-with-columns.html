<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Power Query - Working with columns | PEKâ€™s developer blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Power Query - Working with columns" />
<meta name="author" content="PEK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="When you are working with Power Query you often add, remove and modifying columns in your queries. There are tons of ways to do that, in this part we look on the most common cases." />
<meta property="og:description" content="When you are working with Power Query you often add, remove and modifying columns in your queries. There are tons of ways to do that, in this part we look on the most common cases." />
<link rel="canonical" href="https://pekspro.github.io/posts/power-query-working-with-columns" />
<meta property="og:url" content="https://pekspro.github.io/posts/power-query-working-with-columns" />
<meta property="og:site_name" content="PEKâ€™s developer blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-26T01:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Power Query - Working with columns" />
<script type="application/ld+json">
{"description":"When you are working with Power Query you often add, remove and modifying columns in your queries. There are tons of ways to do that, in this part we look on the most common cases.","headline":"Power Query - Working with columns","dateModified":"2020-07-26T01:00:00+02:00","datePublished":"2020-07-26T01:00:00+02:00","url":"https://pekspro.github.io/posts/power-query-working-with-columns","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pekspro.github.io/posts/power-query-working-with-columns"},"author":{"@type":"Person","name":"PEK"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pekspro.github.io/feed.xml" title="PEK's developer blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PEK&#39;s developer blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/categories">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Power Query - Working with columns</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-07-26T01:00:00+02:00" itemprop="datePublished">
        Jul 26, 2020
      </time>
        â€¢  Categories: 
        <a href="/categories#excel">Excel</a>
      </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">
    <p>When you are working with Power Query you often add, remove and modifying
columns in your queries. There are tons of ways to do that, in this part we look
on the most common cases.</p>

<p>Before you read on, make sure you have completed the previous part 
<a href="/posts/power-query-get-started-in-excel">Power Query - Get started in Excel</a>
because we continue working with the data we created there.</p>

<h2 id="combining-data-into-a-new-column">Combining data into a new column</h2>

<p>In the panel <strong>Queries &amp; Connections</strong> double click on <strong>Player</strong> to open the
Power Query editor again.</p>

<p><img src="/assets/images/0016/excel_query_player.png" alt="Player Query Result" title="Player Query Result" /></p>

<p>Now the Power Query editor should look something like this:</p>

<p><img src="/assets/images/0016/editor_first_view.png" alt="Editor" title="Editor" /></p>

<p>In the data we have first and last name in two separate columns. The first thing
we will do is to make a new column where we see both these names. Click on <strong>Add
Column</strong> &gt; <strong>Custom column.</strong></p>

<p><img src="/assets/images/0017/editor_menu_addcolumn_customcolumn.png" alt="Add custom column" title="Add custom column" /></p>

<p>Now you get a new window looking like this:</p>

<p><img src="/assets/images/0017/customcolumn_empty.png" alt="Custom column" title="Custom column" /></p>

<p>In this window you give the new column a new and enter a formula. Enter the
following formula:</p>

<div class="codeHeader" data-bi-name="code-header">
    <span class="language"> Formula </span>
    <button type="button" class="action is-relative copy-code-button" aria-label="Copy code">
        <span style="font-size: .800em; margin-right: .25em; position: relative; top: -.25em; left: -.200em; pointer-events: none;">
            ðŸ“„<span style="position: absolute; top: .25em; left: .25em">ðŸ“„</span>
        </span>
        <span style="pointer-events: none;">Copy</span>
        <div class="successful-copy-alert is-transparent" style="pointer-events: none;" aria-hidden="true">
            &#10003;
        </div>
    </button> 
</div>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[First name] &amp; " " &amp; [Country code]</code></pre></figure>

<p>Yes, we are intentionally making a mistake by adding first name with the
country. We will fix that in a moment. Change <strong>New column name</strong> to <strong>Name</strong>.
The window should now look like this:</p>

<p><img src="/assets/images/0017/customcolumn_combinestrings.png" alt="Custom column with formula" title="Custom column with formula" /></p>

<p>If it does, click <strong>OK</strong>. The Power Query editor now looks like this:</p>

<p><img src="/assets/images/0017/editor_name_added.png" alt="Name added" title="Name added" /></p>

<p>Note that you now see a new column called <strong>Name</strong>. Also note that in <strong>Applied
steps</strong> a new row has been added.</p>

<h2 id="removing-columns">Removing columns</h2>

<p>We are still pretending that we have not noticed our previous mistake. We do not
want to keep the columns <strong>First name</strong> and <strong>Last name</strong>. Therefore, select the
column you want to remove, click on the <strong>Home</strong> &gt; <strong>Remove columns</strong>.</p>

<p><img src="/assets/images/0017/editor_menu_home_removecolumns.png" alt="Remove columns" title="Remove columns" /></p>

<p>Now the editor should look like this:</p>

<p><img src="/assets/images/0017/editor_name_removed.png" alt="Name removed" title="Name removed" /></p>

<p>As you remember we used the <strong>First name</strong> column in our formula that we created
earlier. If this was an ordinary Excel formula the <strong>Name</strong> column should now be
broken. But in Power Query formulas works in a different way. Have a look on
<strong>Applied steps:</strong></p>

<p><img src="/assets/images/0017/appliedsteps_overview.png" alt="Applied steps" title="Applied steps" /></p>

<p>This is giving us a quick overview on which steps we have taken to create the
query. There are four steps:</p>

<ul>
  <li><strong>Source</strong> â€“ We are getting data from the Excel table</li>
  <li><strong>Change Type</strong> â€“ We specify the data type for every column</li>
  <li><strong>Added Customer</strong> â€“ We added the Name column</li>
  <li><strong>Removed Columns</strong> â€“ We removed the two old name columns.</li>
</ul>

<p>The first two steps we got for free when we created our query in the previous
tutorial. The other two steps we just created.</p>

<p>If you click on any of these steps, you see how the data looks like after that
step has been applied. Click on <strong>Added custom</strong> and <strong>Removed columns</strong> to see
the difference.</p>

<h2 id="changing-a-previous-step">Changing a previous step</h2>

<p>As you might have noticed it is possible to edit each step. In the <strong>Applied
steps</strong> panel, double click on <strong>Added custom.</strong> Now we get back this window:</p>

<p><img src="/assets/images/0017/customcolumn_combinestrings.png" alt="Custom column with formula" title="Custom column with formula" /></p>

<p>Fix our incorrect formula by replacing <strong>[Country code]</strong> with <strong>[Last name]</strong>
and then select <strong>OK</strong>. Now you should see this:</p>

<p><img src="/assets/images/0017/editor_name_fixed.png" alt="Name fixed" title="Name fixed" /></p>

<p>If you in <strong>Applied steps</strong> double click on <strong>Remove Columns</strong> nothing will
happen. That is because there is no explicit editor for removing columns. But
instead, you could edit this formula that you see in the Power Query editor:</p>

<div class="codeHeader" data-bi-name="code-header">
    <span class="language"> Formula </span>
    <button type="button" class="action is-relative copy-code-button" aria-label="Copy code">
        <span style="font-size: .800em; margin-right: .25em; position: relative; top: -.25em; left: -.200em; pointer-events: none;">
            ðŸ“„<span style="position: absolute; top: .25em; left: .25em">ðŸ“„</span>
        </span>
        <span style="pointer-events: none;">Copy</span>
        <div class="successful-copy-alert is-transparent" style="pointer-events: none;" aria-hidden="true">
            &#10003;
        </div>
    </button> 
</div>

<figure class="highlight"><pre><code class="language-text" data-lang="text">= Table.RemoveColumns(#"Added Custom",{"First name", "Last name"})</code></pre></figure>

<p>This formula specifies that <strong>First name</strong> and <strong>Last name</strong> should be removed.
You could edit this formula manually if you want to. You could also remove steps
in <strong>Applied steps</strong> panel.</p>

<h2 id="advanced-editor">Advanced editor</h2>

<p>Click on <strong>Home</strong> &gt; <strong>Advanced Editor</strong>.</p>

<p><img src="/assets/images/0017/editor_menu_home_advancededitor.png" alt="Home &gt; Advanced editor" title="Home &gt; Advanced editor" /></p>

<p>Then you will see this:</p>

<p><img src="/assets/images/0017/advanced_editor.png" alt="Advanced editor" title="Advanced editor" /></p>

<p>This is showing the same information that you see in <strong>Applied steps</strong> but in
more detail. This is what the editor says:</p>

<ul>
  <li>Line 2: Create a table named <strong>Source</strong> from a table in the current file.</li>
  <li>Line 3: Create a new table named <strong>Changed type</strong>, based on the table
<strong>Source</strong> by specifying data type on each column.</li>
  <li>Line 4: Create a new table named <strong>Added custom</strong> based on the table <strong>Change
type</strong> by adding a new column.</li>
  <li>Line 5: Create a new table named <strong>Removed Columns</strong> based on the table
<strong>Added custom</strong> by removing columns.</li>
  <li>Line 7: Use the table <strong>Removed Columns</strong> as the output from the query.</li>
</ul>

<p>In most cases you never need to use the advanced editor, but it is good to know
that it exists. We will not make any changes here so close the editor.</p>

<h2 id="data-types">Data types</h2>

<p>In the Power Query editor, you now should have four columns:</p>

<p><img src="/assets/images/0017/editor_name_fixed.png" alt="Editor" title="Editor" /></p>

<p>In each column one data type per column could be used. One column could for
instance contain whole numbers, another column could contain dates and a third
could contain text. This is different from spread sheets where you specify the
data type on every individual cell.</p>

<p>If you look on the <strong>Birth date</strong> column you see that every cell contains a date
and a time. This because the data type is set to <strong>Date/Time.</strong> Change the data
type by clicking on the icon just left to the column title and change data type
to <strong>Date</strong>.</p>

<p><img src="/assets/images/0017/birthdate_datatype_date.png" alt="Data type - Date" title="Data type - Date" /></p>

<p>Now the editor should look like this:</p>

<p><img src="/assets/images/0017/editor_birthdate_changeddatatype.png" alt="Date fixed" title="Date fixed" /></p>

<p>That is a bit better. If you select a column you see which data type they are
using in <strong>Home &gt; Data type</strong>.</p>

<p><img src="/assets/images/0017/editor_menu_home_datatype.png" alt="Data type" title="Data type" /></p>

<p>Check which data types the other columns are using.</p>

<p>Now we have the birth date in a pretty way in our table. But wouldnâ€™t it be nice
to show the age of each player too?</p>

<h2 id="working-with-dates">Working with dates</h2>

<p>While you have the <strong>Birth date</strong> selected, click on <strong>Add column</strong>, select
<strong>Date</strong> and then in the menu select <strong>Age</strong>.</p>

<p><img src="/assets/images/0017/editor_menu_addcolumn_date_age.png" alt="Get age from date" title="Get age from date" /></p>

<p>Now a new column will be added to the editor:</p>

<p><img src="/assets/images/0017/editor_age_added.png" alt="Age added" title="Age added" /></p>

<p>The <strong>Age</strong> column has the data type <strong>Duration</strong> and it shows the age in days,
hours, minutes, and seconds. This is great for computers, but humans prefer to
calculate age in years, so we need to fix that.</p>

<p>Select the <strong>Age</strong> column, click on <strong>Add column</strong> &gt; <strong>Duration</strong> and select
<strong>Total years.</strong></p>

<p><img src="/assets/images/0017/editor_menu_addcolumn_duration_totalyears.png" alt="Add column &gt; Duration" title="Add column &gt; Duration" /></p>

<p>Now a new column appears showing <strong>Total Years</strong>:</p>

<p><img src="/assets/images/0017/editor_age_duration.png" alt="Total years added" title="Total years added" /></p>

<p>The <strong>Total Years</strong> column is calculated by dividing the <strong>Age</strong> column with 365. 
So, this does not take leap years in account which might be a problem. But
to keep this tutorial simple we will ignore that.</p>

<p>Now we have the age in years, but it is shown as a decimal number. Showing this
as a whole number is preferable. Changing the datatype to <strong>Whole number</strong> might
seem to be a good idea, but then the ages might be rounded incorrectly. Instead
we will specify how they should be rounded. To do this, click on <strong>Transform</strong>,
<strong>Rounding</strong> and select <strong>Round down</strong>.</p>

<p><img src="/assets/images/0017/editor_menu_transform_rounding_rounddown.png" alt="Round down" title="Round down" /></p>

<p>Now the editor should look like this:</p>

<p><img src="/assets/images/0017/editor_age_rounded.png" alt="Age rounded" title="Age rounded" /></p>

<p>This is a lot better. Now, have a look on the <strong>Applied steps</strong> panel. On every
task you did you see a new step in there. You could also edit some of these
steps. For instance, in the step <strong>Inserted age</strong> click on the settings icon.
Now the <strong>Custom column</strong> editor will show the formula that was used when you
selected to insert age. You do not need to change this, so just close this
window.</p>

<p>Every time you decide to add, remove, or transform a column in the tool bar a
formula will be created that you later could edit in the <strong>Applied steps</strong>
panel. Remember that you call see all details in the <strong>Advanced editor</strong>.</p>

<p>Now we will end this by doing some minor clean ups. Make sure you have selected
the last step in the <strong>Applied steps</strong> panel. Start by removing the <strong>Birth
date</strong> and the <strong>Age</strong> columns.</p>

<p>Then, right click on the <strong>Total years</strong> column and select <strong>Rename</strong>. Name the
column <strong>Age</strong>. Now the editor will look like this:</p>

<p><img src="/assets/images/0017/editor_age_cleanedup.png" alt="Age cleaned up" title="Age cleaned up" /></p>

<p>Click on <strong>Home</strong> &gt; <strong>Close &amp; Load</strong>. Now you should be back in ordinary Excel
and you should see this:</p>

<p><img src="/assets/images/0017/excel_player_query_updated.png" alt="Updated query" title="Updated query" /></p>

<p>If you go to <strong>Sheet1</strong> and change a name and a birth date on a player, and then
refresh the query you should see these changes in this view.</p>

<h2 id="summary">Summary</h2>

<p>You can check the final result of this part in this file: 
<a href="/assets/files/0017/power-query-part-2.xlsx">power-query-part-2.xlsx</a>.</p>

<p>In this tutorial learned how to add, remove, and modify columns and how to use
the <strong>Applied steps</strong> panel. In many cases when you will add a column you will
find a short cut in the toolbar that does what you want.</p>

<p>When you have been adding column, you have always based those on the data you
already have in your table. But you could also add columns from other queries,
when look on that in the next part:
<a href="/posts/power-query-joining-data">Power Query - Joining data</a>.</p>

  </div>
  
    <div id="archives" class="related"><div class="archive-group">
    
      
      <div id="#excel"></div>
      <p></p>
  
      <h3 class="category-head">More about Excel</h3>
      
      <article class="archive-item">
        <h4><a href="/posts/be-careful-with-references-in-power-query">Be careful with references in Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-unique-excel-sheet-names">Creating unique Excel sheet names</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/calling-an-api-multiple-times-with-power-query">Calling an API multiple times with Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-accruals-with-power-query">Creating accruals with Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/how-to-use-JWT-token-from-query-string">How to use JWT token from query string</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/using-power-query-and-web-api-with-http-authentication">Power Query and Web API with HTTP authentication</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-and-json-arrays">Power Query and JSON arrays</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/format-tables-in-excel-with-macros">Format tables in Excel with macros</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-excel-files-in-azure-functions">Creating Excel-files in Azure Functions</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-excel-files-in-logic-apps">Creating Excel-files in Logic Apps</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-grouping-and-filtering-data">Power Query - Grouping and filtering data</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-joining-data">Power Query - Joining data</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-get-started-in-excel">Power Query - Get started in Excel</a></h4>
      </article>
      
    </div>
    
  
  </div><a class="u-url" href="/posts/power-query-working-with-columns" hidden></a>
</article>

<script src="/assets/javascript/copybutton.js"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">PEK</li>
          <li><a class="u-email" href="mailto:"></a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Interesting problems with interesting solutions.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pekspro" title="pekspro"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
