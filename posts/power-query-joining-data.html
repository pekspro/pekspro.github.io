<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Power Query - Joining data | PEKâ€™s developer blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Power Query - Joining data" />
<meta name="author" content="PEK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometime useful to combine data from two tables when you are working with Excel. You could do this with functions like VLOOKUP. It works, but it is a pain to use. If you instead are using Power Query, you could easily join data from two tables. If you know SQL, you will find this familiar." />
<meta property="og:description" content="Sometime useful to combine data from two tables when you are working with Excel. You could do this with functions like VLOOKUP. It works, but it is a pain to use. If you instead are using Power Query, you could easily join data from two tables. If you know SQL, you will find this familiar." />
<link rel="canonical" href="https://pekspro.github.io/posts/power-query-joining-data" />
<meta property="og:url" content="https://pekspro.github.io/posts/power-query-joining-data" />
<meta property="og:site_name" content="PEKâ€™s developer blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-02T01:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Power Query - Joining data" />
<script type="application/ld+json">
{"description":"Sometime useful to combine data from two tables when you are working with Excel. You could do this with functions like VLOOKUP. It works, but it is a pain to use. If you instead are using Power Query, you could easily join data from two tables. If you know SQL, you will find this familiar.","headline":"Power Query - Joining data","dateModified":"2020-08-02T01:00:00+02:00","datePublished":"2020-08-02T01:00:00+02:00","url":"https://pekspro.github.io/posts/power-query-joining-data","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pekspro.github.io/posts/power-query-joining-data"},"author":{"@type":"Person","name":"PEK"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pekspro.github.io/feed.xml" title="PEK's developer blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PEK&#39;s developer blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/categories">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Power Query - Joining data</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-08-02T01:00:00+02:00" itemprop="datePublished">
        Aug 2, 2020
      </time>
        â€¢  Categories: 
        <a href="/categories#excel">Excel</a>
      </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">
    <p>Sometime useful to combine data from two tables when you are working with Excel.
You could do this with functions like VLOOKUP. It works, but it is a pain to
use. If you instead are using Power Query, you could easily join data from two
tables. If you know SQL, you will find this familiar.</p>

<p>Before you read on, make sure you have completed the previous part 
<a href="/posts/power-query-working-with-columns">Power Query - Working with columns</a>
because we continue working with the data we created there.</p>

<h2 id="getting-data-from-wikipedia">Getting data from Wikipedia</h2>

<p>The data we have now is just a single table player names, country codes and some
other data. In this part we will add a new column so we could see the name of
the country instead of the country code.</p>

<p>But before we do this, we need a data source where we see with the country code
and country name. For our existing data we use an Excel table as a data source.
This time we will instead use a Wikipedia-page!</p>

<p>In Excel, select <strong>Data</strong> and then <strong>From Web</strong>.</p>

<p><img src="/assets/images/0018/excel_menu_data_fromweb.png" alt="Add data From Web" title="Add data From Web" /></p>

<p>Insert the following URL:</p>

<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2</a></p>

<p>Then click <strong>OK</strong>.</p>

<p><img src="/assets/images/0018/fromweb.png" alt="From Web" title="From Web" /></p>

<p>Now all tables from the page will be loaded and you will be asked to select the
table you want to use. Select the table <strong>Officially assigned code
elements</strong>. Before we use the data, we want to make some modifications.
Therefore, click on <strong>Transform data</strong> (if you select <strong>Load</strong> the table will be
loaded into Excel as it is).</p>

<p><img src="/assets/images/0018/fromweb_selecttable.png" alt="Select table" title="Select table" /></p>

<p>Already it looks pretty good! But there are some data we do not need.</p>

<p><img src="/assets/images/0018/editor_countries.png" alt="Countries" title="Countries" /></p>

<p>First, remove all columns except for the first two.</p>

<p>Then rename the first column to <strong>Country code</strong>.</p>

<p>And then rename the second column to <strong>Country name</strong>.</p>

<p>If you want to cheat, open the <strong>Advanced editor</strong> and replace the content with
this code:</p>

<div class="codeHeader" data-bi-name="code-header">
    <span class="language"> Advanced editor </span>
    <button type="button" class="action is-relative copy-code-button" aria-label="Copy code">
        <span style="font-size: .800em; margin-right: .25em; position: relative; top: -.25em; left: -.200em; pointer-events: none;">
            ðŸ“„<span style="position: absolute; top: .25em; left: .25em">ðŸ“„</span>
        </span>
        <span style="pointer-events: none;">Copy</span>
        <div class="successful-copy-alert is-transparent" style="pointer-events: none;" aria-hidden="true">
            &#10003;
        </div>
    </button> 
</div>

<figure class="highlight"><pre><code class="language-text" data-lang="text">let
    Source = Web.Page(Web.Contents("https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2")),
    Data2 = Source{2}[Data],
    #"Changed Type" = Table.TransformColumnTypes(Data2,{ {"Code", type text}, {"Country name (using title case)", type text}, {"Year", Int64.Type}, {"ccTLD", type text}, {"ISO 3166-2", type text}, {"Notes", type text}}),
    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type",{"Code", "Country name (using title case)"}),
    #"Renamed Columns" = Table.RenameColumns(#"Removed Other Columns",{ {"Code", "Country code"}, {"Country name (using title case)", "Country name"}})
in
    #"Renamed Columns"</code></pre></figure>

<p>In the query settings, change the name to <strong>Country</strong>. If you have done
everything correctly, you should see this:</p>

<p><img src="/assets/images/0018/editor_countries_cleanedup.png" alt="Countries" title="Countries" /></p>

<p>Click on <strong>Home</strong> &gt; <strong>Close &amp; Load</strong> and you should now see the table in Excel.</p>

<p><img src="/assets/images/0018/excel_countries.png" alt="Countries" title="Countries" /></p>

<p>Every time you select to refresh the data; Excel will go to Wikipedia and fetch
all new countries from that page. Pretty cool, I think.</p>

<h2 id="joining-data">Joining data</h2>

<p>In the <strong>Queries &amp; Connections</strong> panel you now have two queries. Now we will
combine these two. Right click on <strong>Player</strong> and select <strong>Merge</strong>.</p>

<p><img src="/assets/images/0018/query_player_merge.png" alt="Player &gt; Merge" title="Player &gt; Merge" /></p>

<p>Now you will see a new window where you select which tables you want to merge.
You should also select on which columns which the data will be joined. We are
just using the column named <strong>Country code</strong> in each table, but it is possible
to join data on multiple columns.</p>

<p>You should also select how the data should be joined with the <strong>Join Kind</strong>
setting. This time we use <strong>Left Outer</strong>. Make sure you have setup this like the
image below and then click <strong>OK</strong>.</p>

<p><img src="/assets/images/0018/merge_player_country.png" alt="Configure merge" title="Configure merge" /></p>

<p>Now the Power Query editor look like this:</p>

<p><img src="/assets/images/0018/editor_merge.png" alt="Editor" title="Editor" /></p>

<p>As you see you have all the columns from the <strong>Players</strong> table. But you also
have a new column named <strong>Country.</strong> In this column you have all the matching
rows from the <strong>Country</strong> table. To make this more useful, click on the expand
button and select that you only want to see the <strong>Country name</strong> column.</p>

<p><img src="/assets/images/0018/editor_country_expand.png" alt="Expand country" title="Expand country" /></p>

<p>After you have clicked <strong>OK</strong> you will see the name of the country of each
player in a new column. Rename this column to <strong>Country name</strong>. Also remove the
column <strong>Country code</strong>. And then change the name of this query to
<strong>PlayerCountry</strong>.</p>

<p><img src="/assets/images/0018/editor_playercountry.png" alt="PlayerCountry" title="PlayerCountry" /></p>

<p>Then select <strong>Home</strong> &gt; <strong>Close &amp; Load</strong> to see the data in Excel.</p>

<p><img src="/assets/images/0018/excel_playercountry.png" alt="PlayerCountry in Excel" title="PlayerCountry in Excel" /></p>

<p>Well done! As you see you now have a third query in the <strong>Queries &amp; Connections</strong> panel.</p>

<p>Now you could do some experiments. Go to <strong>Sheet1</strong> were you have your original
data. Change the country code of a person. Then select <strong>Data</strong> and then
<strong>Refresh all</strong>.</p>

<p><img src="/assets/images/0016/excel_menu_data_refreshall.png" alt="Refresh all" title="Refresh all" /></p>

<p>After a few seconds you will see the new country name on the person you changed.
Remember that when you pressed that button, data was fetched and analyzed from
Wikipedia and combined with the data that you have in spreadsheet.</p>

<h2 id="summary">Summary</h2>

<p>You can check the final result of this part in this file: 
<a href="/assets/files/0018/power-query-part-3.xlsx">power-query-part-3.xlsx</a>.</p>

<p>In this tutorial we fetched data from Wikipedia and merged it local data. After
this I hope you see the power with Power Query. Obviously, you could get data
from other data sources, like a real SQL database or some external Excel file.
Just click on <strong>Data</strong> &gt; <strong>Get Data</strong> to see which options are available.</p>

<p>But this is not all! There is one other major concept left we will look into the
next part: <a href="/posts/power-query-grouping-and-filtering-data">Power Query - Grouping and filtering data</a>.</p>

  </div>
  
    <div id="archives" class="related"><div class="archive-group">
    
      
      <div id="#excel"></div>
      <p></p>
  
      <h3 class="category-head">More about Excel</h3>
      
      <article class="archive-item">
        <h4><a href="/posts/be-careful-with-references-in-power-query">Be careful with references in Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-unique-excel-sheet-names">Creating unique Excel sheet names</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/calling-an-api-multiple-times-with-power-query">Calling an API multiple times with Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-accruals-with-power-query">Creating accruals with Power Query</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/how-to-use-JWT-token-from-query-string">How to use JWT token from query string</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/using-power-query-and-web-api-with-http-authentication">Power Query and Web API with HTTP authentication</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-and-json-arrays">Power Query and JSON arrays</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/format-tables-in-excel-with-macros">Format tables in Excel with macros</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-excel-files-in-azure-functions">Creating Excel-files in Azure Functions</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/creating-excel-files-in-logic-apps">Creating Excel-files in Logic Apps</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-grouping-and-filtering-data">Power Query - Grouping and filtering data</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-working-with-columns">Power Query - Working with columns</a></h4>
      </article>
      
      <article class="archive-item">
        <h4><a href="/posts/power-query-get-started-in-excel">Power Query - Get started in Excel</a></h4>
      </article>
      
    </div>
    
  
  </div><a class="u-url" href="/posts/power-query-joining-data" hidden></a>
</article>

<script src="/assets/javascript/copybutton.js"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">PEK</li>
          <li><a class="u-email" href="mailto:"></a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Interesting problems with interesting solutions.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pekspro" title="pekspro"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
