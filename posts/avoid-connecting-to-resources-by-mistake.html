<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Avoid connecting to resources by mistake | PEKâ€™s developer blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Avoid connecting to resources by mistake" />
<meta name="author" content="PEK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Being able to connect to any resource at any time is both convenient and scary â€“ especially if you are a developer. Here is a little trick that reduces the risk a bit." />
<meta property="og:description" content="Being able to connect to any resource at any time is both convenient and scary â€“ especially if you are a developer. Here is a little trick that reduces the risk a bit." />
<link rel="canonical" href="https://pekspro.github.io/posts/avoid-connecting-to-resources-by-mistake" />
<meta property="og:url" content="https://pekspro.github.io/posts/avoid-connecting-to-resources-by-mistake" />
<meta property="og:site_name" content="PEKâ€™s developer blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-07T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Avoid connecting to resources by mistake" />
<script type="application/ld+json">
{"description":"Being able to connect to any resource at any time is both convenient and scary â€“ especially if you are a developer. Here is a little trick that reduces the risk a bit.","headline":"Avoid connecting to resources by mistake","dateModified":"2021-02-07T00:00:00+01:00","datePublished":"2021-02-07T00:00:00+01:00","url":"https://pekspro.github.io/posts/avoid-connecting-to-resources-by-mistake","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pekspro.github.io/posts/avoid-connecting-to-resources-by-mistake"},"author":{"@type":"Person","name":"PEK"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pekspro.github.io/feed.xml" title="PEK's developer blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PEK&#39;s developer blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/categories">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Avoid connecting to resources by mistake</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-02-07T00:00:00+01:00" itemprop="datePublished">
        Feb 7, 2021
      </time>
        â€¢  Categories: 
        <a href="/categories#azure">Azure</a>
      </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">
    <p>Being able to connect to any resource at any time is both convenient and scary â€“
especially if you are a developer. Here is a little trick that reduces the risk
a bit.</p>

<h2 id="the-problem">The problem</h2>

<p>When I work with projects that are deployed to Azure, I often have one
environment for testing and another for production. Access key and passwords are
different in these environments. This makes it harder to connect to incorrect
resource by mistake, but sometimes I find this not to be good enough. I would
like to deny my developer machine to connect to production resources.</p>

<h2 id="the-solution">The solution</h2>

<p>When you are connecting an Azure resource you often, if not always, use DNS. For
instance, you are using <code class="language-plaintext highlighter-rouge">mysqldb.database.windows.net</code> for SQL databases and
<code class="language-plaintext highlighter-rouge">mykeyvault.vault.azure.net</code> for Azure Key Vault.</p>

<p>My solution is to map production DNS names to my own machine. This way, when I
try to connect to a production resource I will instead connect to my own machine
and an error will occur â€“ exactly what I want.</p>

<p>To do this, open the file <code class="language-plaintext highlighter-rouge">C:\Windows\System32\drivers\etc\hosts</code>. Then you
could redirect the resources you want to your own machine (<code class="language-plaintext highlighter-rouge">127.0.0.1</code>) like
this:</p>

<div class="codeHeader" data-bi-name="code-header">
    <span class="language"> hosts </span>
    <button type="button" class="action is-relative copy-code-button" aria-label="Copy code">
        <span style="font-size: .800em; margin-right: .25em; position: relative; top: -.25em; left: -.200em; pointer-events: none;">
            ðŸ“„<span style="position: absolute; top: .25em; left: .25em">ðŸ“„</span>
        </span>
        <span style="pointer-events: none;">Copy</span>
        <div class="successful-copy-alert is-transparent" style="pointer-events: none;" aria-hidden="true">
            &#10003;
        </div>
    </button> 
</div>

<figure class="highlight"><pre><code class="language-config" data-lang="config"><span class="c"># Azure SQL
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mysql</span>.<span class="n">database</span>.<span class="n">windows</span>.<span class="n">net</span>

<span class="c"># Cosmos database
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mycosmosdb</span>.<span class="n">documents</span>.<span class="n">azure</span>.<span class="n">com</span>
<span class="c"># Azure key vault
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">myvault</span>.<span class="n">vault</span>.<span class="n">azure</span>.<span class="n">net</span>
<span class="c"># Azure configuration 
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">myconfig</span>.<span class="n">azconfig</span>.<span class="n">io</span>

<span class="c"># Storage-Blob
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mystorage</span>.<span class="n">blob</span>.<span class="n">core</span>.<span class="n">windows</span>.<span class="n">net</span>
<span class="c"># Storage-Files
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mystorage</span>.<span class="n">file</span>.<span class="n">core</span>.<span class="n">windows</span>.<span class="n">net</span>
<span class="c"># Storage-Queue
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mystorage</span>.<span class="n">queue</span>.<span class="n">core</span>.<span class="n">windows</span>.<span class="n">net</span>
<span class="c"># Storage-Table
</span><span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>	<span class="n">mystorage</span>.<span class="n">table</span>.<span class="n">core</span>.<span class="n">windows</span>.<span class="n">net</span></code></pre></figure>

<p>Be aware that since this is a system file you need special permissions to change
it. You could change the permission on the file or store it somewhere else and
then copy it with Explorer that then could give you temporary permission.</p>

<p>Also, be aware that after these changes some services may <strong>no longer work
properly in Azure Portal</strong>. I have noticed problems both with Azure KeyVault and
Azure AppConfiguration were I got strange error messages in the portal. Other
services might also be affected.</p>

<h2 id="summary">Summary</h2>

<p>Clearly, this is neither a perfect solution nor solves every case. But it does
add an extra layer of protection to my production resources from the most
unreliable system â€“ myself.</p>

  </div>
  
    <div id="archives" class="related"><div class="archive-group">
    
      
      <div id="#azure"></div>
      <p></p>
  
      <h3 class="category-head">More about Azure</h3>
      
      <article class="archive-item">
        <h4><a href="/posts/redirect-with-azure-cdn">Redirect with Azure CDN</a></h4>
      </article>
      
    </div>
    
  
  </div><a class="u-url" href="/posts/avoid-connecting-to-resources-by-mistake" hidden></a>
</article>

<script src="/assets/javascript/copybutton.js"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">PEK</li>
          <li><a class="u-email" href="mailto:"></a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Interesting problems with interesting solutions.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pekspro" title="pekspro"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
